prepost$ROCIADOR[prepost$ROCIADOR == "OSCAR BARRIOS"] <- "OSCAR BARRIOS ZEA"
prepost$ROCIADOR[prepost$ROCIADOR == "VIDAL MAYTA"] <- "VIDAL MAYTA HUANCA"
prepost$ROCIADOR[prepost$ROCIADOR == "E. MANZANEDA"] <- "EDGAR MANZANEDA"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "VANDER TICONA"] <- "VANDER TICONA CUBA"
prepost$ROCIADOR[prepost$ROCIADOR == "EDGAR TITO"] <- "EDGARD TITO"
prepost$ROCIADOR[prepost$ROCIADOR == "RAFAEL VALDIVIA"] <- "RAFAEL VALDIVIA RODRIGUEZ"
prepost$IdObserver <- unlist(0)
prepost$IdObserver <- as.numeric(factor(prepost$ROCIADOR))
prepost$JEFEVIV <- toupper(iconv(prepost$JEFEVIV, to="ASCII//TRANSLIT"))
prepost$STATUS <- prepost$Residual_T==1
prepost$STATUS[prepost$STATUS==1] <- "T"
write.csv(prepost,"generalRociadoPA_Javier.csv",row.names=FALSE)
levels(as.factor(prepost$STATUS))
source("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/spatcontrol/spatcontrol.R",chdir=TRUE,echo = F)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
post2009<-read.csv("cons_roc_2009_2015javier.csv",header=TRUE)
post2009$Residual_T <- 0
post2009$Residual_T <- as.numeric(post2009$P != 0)
post2009nr <- read.csv("viv_no_roc_Jav.csv")
head (post2009nr)
post2009nr$Residual_R <- unlist(0)
post2009nr$Residual_C <- unlist(0)
post2009nr$Residual_D <- unlist(0)
post2009nr$Residual_LP <- unlist(0)
post2009nr$Residual_LV <- unlist(0)
post2009nr$Residual_R <- as.numeric(post2009nr$STATUS== "R")
post2009nr$Residual_C <- as.numeric(post2009nr$STATUS == "C")
post2009nr$Residual_D <- as.numeric(post2009nr$STATUS == "DES")
post2009nr$Residual_LP <- as.numeric(post2009nr$STATUS == "LP")
post2009nr$Residual_LV <- as.numeric(post2009nr$STATUS == "LV")
lqf<-setdiff(names(post2009),names(post2009nr))
for(nombre in lqf){
post2009nr[[nombre]]<-0
}
lqf<-setdiff(names(post2009nr),names(post2009))
for(nombre in lqf){
post2009[[nombre]]<-0
}
post2009completo<-rbind.general(post2009nr,post2009)
write.csv(post2009completo,"CONS_ROCIADO_2009_2015_con_cerradas.csv",row.names=FALSE)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
pre2009<-read.csv("UNION_ROCIADOS.csv",header=TRUE, sep=";")
head(pre2009)
post2009<-read.csv("CONS_ROCIADO_2009_2015_con_cerradas.csv",header=TRUE)
head(post2009)
pre2009<-set_to(pre2009,init=c("NULL"),final=0)
post2009<-set_to(post2009)
colnames(pre2009)[colnames(pre2009)=="I.cap.T"] <- "IN_TRI"
colnames(pre2009)[colnames(pre2009)=="P.cap.T"] <- "PE_TRI"
colnames(pre2009)[colnames(pre2009)=="Nb.cargas"] <- "CARGASNTSCD"
colnames(pre2009)[colnames(pre2009)=="sup.m2"] <- "SUPER"
colnames(pre2009)[colnames(pre2009)=="CICLO"] <- "CICLO_ROCIADO"
colnames(pre2009)[colnames(pre2009)=="OBSERVACIONES"] <- "NOTAS"
colnames(pre2009)[colnames(pre2009)=="I.num.amb"] <- "IN_AMB"
colnames(pre2009)[colnames(pre2009)=="P.num.amb"] <- "PE_AMB"
colnames(pre2009)[colnames(pre2009)=="I.Gri"] <- "IN_GRI"
colnames(pre2009)[colnames(pre2009)=="P.Gri"] <- "PE_GRI"
colnames(pre2009)[colnames(pre2009)=="I.S"] <- "IN_SIL"
colnames(pre2009)[colnames(pre2009)=="I.NO"] <- "IN_NOB"
colnames(pre2009)[colnames(pre2009)=="I.AD"] <- "IN_ADO"
colnames(pre2009)[colnames(pre2009)=="I.LSE"] <- "IN_LAD"
colnames(pre2009)[colnames(pre2009)=="P.S"] <- "PE_SIL"
colnames(pre2009)[colnames(pre2009)=="P.NO"] <- "PE_NOB"
colnames(pre2009)[colnames(pre2009)=="P.LSE"] <- "PE_LAD"
colnames(pre2009)[colnames(pre2009)=="P.AD"] <- "PE_ADO"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.DEL.BRIGADISTA"] <- "ROCIADOR"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.JEFE.DE.FAMILIA"] <- "JEFEVIV"
colnames(pre2009)[colnames(pre2009)=="No.RESID"] <- "NUMRES"
colnames(pre2009)[colnames(pre2009)=="P.otro"] <- "PE_MAT"
colnames(pre2009)[colnames(pre2009)=="I.otro"] <- "IN_MAT"
names(pre2009) <- gsub("\\.", "_", names(pre2009))
names(post2009) <- gsub("\\.", "_", names(post2009))
pre2009$Residual_T <- as.numeric(pre2009$Residual_Rec == 1 | pre2009$Residual_T == 1)
pre2009$Residual_LV <- unlist(0)
pre2009$Residual_LP <- unlist(0)
post2009$CU <- unlist(0)
post2009$CO <- unlist(0)
post2009$OV <- unlist(0)
post2009$PE <- unlist(0)
post2009$AV <- unlist(0)
post2009$GA <- unlist(0)
post2009$CU <- ifelse((post2009$TEC_CUY== 1 | post2009$PAT_CUY == 1),1,0)
post2009$CO <- ifelse((post2009$TEC_CON == 1 | post2009$PAT_CON == 1), 1,0)
post2009$OV <- ifelse((post2009$TEC_OVE == 1 | post2009$PAT_OVE == 1), 1,0)
post2009$PE <- ifelse((post2009$TEC_PER == 1 | post2009$PAT_PER == 1), 1,0)
post2009$AV <- ifelse((post2009$TEC_AVE== 1 | post2009$PAT_AVE == 1), 1,0)
post2009$GA <- ifelse((post2009$TEC_GAT == 1 | post2009$PAT_GAT == 1), 1,0)
pre2009$PE_BLOQ <- 0
pre2009$PE_BLOQ[grep("BLOQ",pre2009$PE_MAT)] <- 1
pre2009$PE_PIE <- 0
pre2009$PE_PIE[grep("PIE",pre2009$PE_MAT)] <- 1
pre2009$FR_A <- ifelse(pre2009$FR_A <= 9,2000+pre2009$FR_A, pre2009$FR_A)
pre2009$FR_A[pre2009$FR_A == 2000] <- 0
pre2009$STATUS <- ifelse(pre2009$Residual_T==1,"T",0)
pre2009$STATUS <- ifelse(pre2009$Residual_T==1,"T",0)
pre2009$STATUS <- ifelse(pre2009$Residual_R==1,"R",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_C==1,"C",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_D==1,"DES",pre2009$STATUS)
pre2009$STATUS[(pre2009$STATUS==0) & grepl("P.",pre2009$NOTAS, fixed = TRUE)] <- "LP"
pre2009$STATUS[(pre2009$STATUS==0) & (grepl("V.",pre2009$NOTAS, fixed = TRUE) | grepl("LOTE VACIO",pre2009$NOTAS))] <- "LV"
levels(as.factor(pre2009$STATUS)
)
levels(as.factor(post2009$STATUS))
table(post2009completo$STATUS)
table(post2009$STATUS)
source("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/spatcontrol/spatcontrol.R",chdir=TRUE,echo = F)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
post2009<-read.csv("cons_roc_2009_2015javier.csv",header=TRUE)
post2009$Residual_T <- 0
post2009$Residual_T <- as.numeric(post2009$P != 0)
View(post2009)
post2009nr <- read.csv("viv_no_roc_Jav.csv")
head (post2009nr)
post2009nr$Residual_R <- unlist(0)
post2009nr$Residual_C <- unlist(0)
post2009nr$Residual_D <- unlist(0)
post2009nr$Residual_LP <- unlist(0)
post2009nr$Residual_LV <- unlist(0)
post2009nr$Residual_R <- as.numeric(post2009nr$STATUS== "R")
post2009nr$Residual_C <- as.numeric(post2009nr$STATUS == "C")
post2009nr$Residual_D <- as.numeric(post2009nr$STATUS == "DES")
post2009nr$Residual_LP <- as.numeric(post2009nr$STATUS == "LP")
post2009nr$Residual_LV <- as.numeric(post2009nr$STATUS == "LV")
lqf<-setdiff(names(post2009),names(post2009nr))
for(nombre in lqf){
post2009nr[[nombre]]<-0
}
lqf<-setdiff(names(post2009nr),names(post2009))
for(nombre in lqf){
post2009[[nombre]]<-0
}
post2009completo<-rbind.general(post2009nr,post2009)
View(post2009completo)
write.csv(post2009completo,"CONS_ROCIADO_2009_2015_con_cerradas.csv",row.names=FALSE)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
pre2009<-read.csv("UNION_ROCIADOS.csv",header=TRUE, sep=";")
head(pre2009)
post2009<-read.csv("CONS_ROCIADO_2009_2015_con_cerradas.csv",header=TRUE)
head(post2009)
View(post2009)
levels(as.factor(post2009$STATUS))
source("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/spatcontrol/spatcontrol.R",chdir=TRUE,echo = F)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
post2009<-read.csv("cons_roc_2009_2015javier.csv",header=TRUE)
View(post2009)
post2009$Residual_T <- 0
post2009$Residual_T <- as.numeric(post2009$P != 0)
levels(as.factor(post2009$STATUS))
post2009nr <- read.csv("viv_no_roc_Jav.csv")
head (post2009nr)
post2009nr$Residual_R <- unlist(0)
post2009nr$Residual_C <- unlist(0)
post2009nr$Residual_D <- unlist(0)
post2009nr$Residual_LP <- unlist(0)
post2009nr$Residual_LV <- unlist(0)
post2009nr$Residual_R <- as.numeric(post2009nr$STATUS== "R")
post2009nr$Residual_C <- as.numeric(post2009nr$STATUS == "C")
post2009nr$Residual_D <- as.numeric(post2009nr$STATUS == "DES")
post2009nr$Residual_LP <- as.numeric(post2009nr$STATUS == "LP")
post2009nr$Residual_LV <- as.numeric(post2009nr$STATUS == "LV")
View(post2009nr)
levels(as.factor(post2009$STATUS))
lqf<-setdiff(names(post2009),names(post2009nr))
for(nombre in lqf){
post2009nr[[nombre]]<-0
}
lqf<-setdiff(names(post2009nr),names(post2009))
for(nombre in lqf){
post2009[[nombre]]<-0
}
post2009completo<-rbind.general(post2009nr,post2009)
View(post2009completo)
rm(post2009)
rm(post2009completo)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
post2009<-read.csv("cons_roc_2009_2015javier.csv",header=TRUE)
post2009$Residual_T <- 0
post2009$Residual_T <- as.numeric(post2009$P != 0)
post2009$STATUS <- as.character(post2009$Residual_T == 1)
post2009$STATUS[post2009$STATUS==1] <- "T"
View(post2009)
post2009$STATUS <- unlist("T")
post2009nr <- read.csv("viv_no_roc_Jav.csv")
head (post2009nr)
post2009nr$Residual_R <- unlist(0)
post2009nr$Residual_C <- unlist(0)
post2009nr$Residual_D <- unlist(0)
post2009nr$Residual_LP <- unlist(0)
post2009nr$Residual_LV <- unlist(0)
post2009nr$Residual_R <- as.numeric(post2009nr$STATUS== "R")
post2009nr$Residual_C <- as.numeric(post2009nr$STATUS == "C")
post2009nr$Residual_D <- as.numeric(post2009nr$STATUS == "DES")
post2009nr$Residual_LP <- as.numeric(post2009nr$STATUS == "LP")
post2009nr$Residual_LV <- as.numeric(post2009nr$STATUS == "LV")
lqf<-setdiff(names(post2009),names(post2009nr))
for(nombre in lqf){
post2009nr[[nombre]]<-0
}
lqf<-setdiff(names(post2009nr),names(post2009))
for(nombre in lqf){
post2009[[nombre]]<-0
}
post2009completo<-rbind.general(post2009nr,post2009)
write.csv(post2009completo,"CONS_ROCIADO_2009_2015_con_cerradas.csv",row.names=FALSE)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
pre2009<-read.csv("UNION_ROCIADOS.csv",header=TRUE, sep=";")
head(pre2009)
post2009<-read.csv("CONS_ROCIADO_2009_2015_con_cerradas.csv",header=TRUE)
head(post2009)
pre2009<-set_to(pre2009,init=c("NULL"),final=0)
post2009<-set_to(post2009)
colnames(pre2009)[colnames(pre2009)=="I.cap.T"] <- "IN_TRI"
colnames(pre2009)[colnames(pre2009)=="P.cap.T"] <- "PE_TRI"
colnames(pre2009)[colnames(pre2009)=="Nb.cargas"] <- "CARGASNTSCD"
colnames(pre2009)[colnames(pre2009)=="sup.m2"] <- "SUPER"
colnames(pre2009)[colnames(pre2009)=="CICLO"] <- "CICLO_ROCIADO"
colnames(pre2009)[colnames(pre2009)=="OBSERVACIONES"] <- "NOTAS"
colnames(pre2009)[colnames(pre2009)=="I.num.amb"] <- "IN_AMB"
colnames(pre2009)[colnames(pre2009)=="P.num.amb"] <- "PE_AMB"
colnames(pre2009)[colnames(pre2009)=="I.Gri"] <- "IN_GRI"
colnames(pre2009)[colnames(pre2009)=="P.Gri"] <- "PE_GRI"
colnames(pre2009)[colnames(pre2009)=="I.S"] <- "IN_SIL"
colnames(pre2009)[colnames(pre2009)=="I.NO"] <- "IN_NOB"
colnames(pre2009)[colnames(pre2009)=="I.AD"] <- "IN_ADO"
colnames(pre2009)[colnames(pre2009)=="I.LSE"] <- "IN_LAD"
colnames(pre2009)[colnames(pre2009)=="P.S"] <- "PE_SIL"
colnames(pre2009)[colnames(pre2009)=="P.NO"] <- "PE_NOB"
colnames(pre2009)[colnames(pre2009)=="P.LSE"] <- "PE_LAD"
colnames(pre2009)[colnames(pre2009)=="P.AD"] <- "PE_ADO"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.DEL.BRIGADISTA"] <- "ROCIADOR"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.JEFE.DE.FAMILIA"] <- "JEFEVIV"
colnames(pre2009)[colnames(pre2009)=="No.RESID"] <- "NUMRES"
colnames(pre2009)[colnames(pre2009)=="P.otro"] <- "PE_MAT"
colnames(pre2009)[colnames(pre2009)=="I.otro"] <- "IN_MAT"
names(pre2009) <- gsub("\\.", "_", names(pre2009))
names(post2009) <- gsub("\\.", "_", names(post2009))
pre2009$Residual_T <- as.numeric(pre2009$Residual_Rec == 1 | pre2009$Residual_T == 1)
pre2009$Residual_LV <- unlist(0)
pre2009$Residual_LP <- unlist(0)
post2009$CU <- unlist(0)
post2009$CO <- unlist(0)
post2009$OV <- unlist(0)
post2009$PE <- unlist(0)
post2009$AV <- unlist(0)
post2009$GA <- unlist(0)
post2009$CU <- ifelse((post2009$TEC_CUY== 1 | post2009$PAT_CUY == 1),1,0)
post2009$CO <- ifelse((post2009$TEC_CON == 1 | post2009$PAT_CON == 1), 1,0)
post2009$OV <- ifelse((post2009$TEC_OVE == 1 | post2009$PAT_OVE == 1), 1,0)
post2009$PE <- ifelse((post2009$TEC_PER == 1 | post2009$PAT_PER == 1), 1,0)
post2009$AV <- ifelse((post2009$TEC_AVE== 1 | post2009$PAT_AVE == 1), 1,0)
post2009$GA <- ifelse((post2009$TEC_GAT == 1 | post2009$PAT_GAT == 1), 1,0)
pre2009$PE_BLOQ <- 0
pre2009$PE_BLOQ[grep("BLOQ",pre2009$PE_MAT)] <- 1
pre2009$PE_PIE <- 0
pre2009$PE_PIE[grep("PIE",pre2009$PE_MAT)] <- 1
pre2009$FR_A <- ifelse(pre2009$FR_A <= 9,2000+pre2009$FR_A, pre2009$FR_A)
pre2009$FR_A[pre2009$FR_A == 2000] <- 0
pre2009$STATUS <- ifelse(pre2009$Residual_T==1,"T",0)
pre2009$STATUS <- ifelse(pre2009$Residual_R==1,"R",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_C==1,"C",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_D==1,"DES",pre2009$STATUS)
pre2009$STATUS[(pre2009$STATUS==0) & grepl("P.",pre2009$NOTAS, fixed = TRUE)] <- "LP"
pre2009$STATUS[(pre2009$STATUS==0) & (grepl("V.",pre2009$NOTAS, fixed = TRUE) | grepl("LOTE VACIO",pre2009$NOTAS))] <- "LV"
pre2009$UNICODE<-paste(pre2009$P,pre2009$D,pre2009$L,pre2009$V,sep=".")
colnames(post2009)[colnames(post2009)=="JEFE_FAMILIA"] <- "JEFEVIV"
colnames(post2009)[colnames(post2009)=="BRIGADISTA"] <- "ROCIADOR"
colnames(post2009)[colnames(post2009)=="I_NUM_AMB"] <- "IN_AMB"
colnames(post2009)[colnames(post2009)=="I_S" ] <- "IN_SIL"
colnames(post2009)[colnames(post2009)=="I_NO"] <-  "IN_NOB"
colnames(post2009)[colnames(post2009)=="I_LAD" ] <- "IN_LAD"
colnames(post2009)[colnames(post2009)== "I_AD"] <-"IN_ADO"
colnames(post2009)[colnames(post2009)=="I_TRIAT"] <- "IN_TRI"
colnames(post2009)[colnames(post2009)=="P_GRI"] <- "PE_GRI"
colnames(post2009)[colnames(post2009)=="P_TRIAT"] <- "PE_TRI"
colnames(post2009)[colnames(post2009)=="No_CARGAS"] <-"CARGASNTSCD"
colnames(post2009)[colnames(post2009)=="SUP_M2"] <- "SUPER"
colnames(post2009)[colnames(post2009)=="OBSERVACIONES" ] <- "NOTAS"
colnames(post2009)[colnames(post2009)=="P_BLOQ" ] <- "PE_BLOQ"
colnames(post2009)[colnames(post2009)=="P_PIE"] <-  "PE_PIE"
colnames(post2009)[colnames(post2009)=="I_GRI"] <- "IN_GRI"
colnames(post2009)[colnames(post2009)=="P_S" ] <-  "PE_SIL"
prepost<-rbind.general(pre2009,post2009)
length(intersect(names(pre2009),names(post2009)))
prepost$PE_SIL[prepost$PE_SIL == 24] <- 1
prepost$IN_GRI[prepost$IN_GRI == "X"] <- 1
prepost$PE_GRI[prepost$PE_GRI == "X"] <- 1
prepost$IN_GRI[prepost$IN_GRI == 3] <- 1
prepost$ROCIADOR <- toupper(iconv(prepost$ROCIADOR, to="ASCII//TRANSLIT"))
prepost$ROCIADOR <- gsub(" *$","",prepost$ROCIADOR)
prepost$ROCIADOR <- gsub(" [A-Z].$","",prepost$ROCIADOR)
prepost$ROCIADOR[prepost$ROCIADOR == "CARLOS VELAVELA"] <- "CARLOS VELA VELA"
prepost$ROCIADOR[prepost$ROCIADOR == "CRISTIAN VELASQUEZ"] <- "CRISTHIAN VELASQUEZ"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "OSCAR BARRIOS"] <- "OSCAR BARRIOS ZEA"
prepost$ROCIADOR[prepost$ROCIADOR == "VIDAL MAYTA"] <- "VIDAL MAYTA HUANCA"
prepost$ROCIADOR[prepost$ROCIADOR == "E. MANZANEDA"] <- "EDGAR MANZANEDA"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "VANDER TICONA"] <- "VANDER TICONA CUBA"
prepost$ROCIADOR[prepost$ROCIADOR == "EDGAR TITO"] <- "EDGARD TITO"
prepost$ROCIADOR[prepost$ROCIADOR == "RAFAEL VALDIVIA"] <- "RAFAEL VALDIVIA RODRIGUEZ"
prepost$IdObserver <- unlist(0)
prepost$IdObserver <- as.numeric(factor(prepost$ROCIADOR))
prepost$JEFEVIV <- toupper(iconv(prepost$JEFEVIV, to="ASCII//TRANSLIT"))
prepost$STATUS <- prepost$Residual_T==1
prepost$STATUS[prepost$STATUS==1] <- "T"
write.csv(prepost,"generalRociadoPA_Javier.csv",row.names=FALSE)
setwd("/home/javier/Documentos/javier/bd_minsa/MINSA TOTAL PREPOST/resultados")
pre2009<-read.csv("UNION_ROCIADOS.csv",header=TRUE, sep=";")
head(pre2009)
post2009<-read.csv("CONS_ROCIADO_2009_2015_con_cerradas.csv",header=TRUE)
head(post2009)
pre2009<-set_to(pre2009,init=c("NULL"),final=0)
post2009<-set_to(post2009)
colnames(pre2009)[colnames(pre2009)=="I.cap.T"] <- "IN_TRI"
colnames(pre2009)[colnames(pre2009)=="P.cap.T"] <- "PE_TRI"
colnames(pre2009)[colnames(pre2009)=="Nb.cargas"] <- "CARGASNTSCD"
colnames(pre2009)[colnames(pre2009)=="sup.m2"] <- "SUPER"
colnames(pre2009)[colnames(pre2009)=="CICLO"] <- "CICLO_ROCIADO"
colnames(pre2009)[colnames(pre2009)=="OBSERVACIONES"] <- "NOTAS"
colnames(pre2009)[colnames(pre2009)=="I.num.amb"] <- "IN_AMB"
colnames(pre2009)[colnames(pre2009)=="P.num.amb"] <- "PE_AMB"
colnames(pre2009)[colnames(pre2009)=="I.Gri"] <- "IN_GRI"
colnames(pre2009)[colnames(pre2009)=="P.Gri"] <- "PE_GRI"
colnames(pre2009)[colnames(pre2009)=="I.S"] <- "IN_SIL"
colnames(pre2009)[colnames(pre2009)=="I.NO"] <- "IN_NOB"
colnames(pre2009)[colnames(pre2009)=="I.AD"] <- "IN_ADO"
colnames(pre2009)[colnames(pre2009)=="I.LSE"] <- "IN_LAD"
colnames(pre2009)[colnames(pre2009)=="P.S"] <- "PE_SIL"
colnames(pre2009)[colnames(pre2009)=="P.NO"] <- "PE_NOB"
colnames(pre2009)[colnames(pre2009)=="P.LSE"] <- "PE_LAD"
colnames(pre2009)[colnames(pre2009)=="P.AD"] <- "PE_ADO"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.DEL.BRIGADISTA"] <- "ROCIADOR"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.JEFE.DE.FAMILIA"] <- "JEFEVIV"
colnames(pre2009)[colnames(pre2009)=="No.RESID"] <- "NUMRES"
colnames(pre2009)[colnames(pre2009)=="P.otro"] <- "PE_MAT"
colnames(pre2009)[colnames(pre2009)=="I.otro"] <- "IN_MAT"
names(pre2009) <- gsub("\\.", "_", names(pre2009))
names(post2009) <- gsub("\\.", "_", names(post2009))
pre2009$Residual_T <- as.numeric(pre2009$Residual_Rec == 1 | pre2009$Residual_T == 1)
pre2009$Residual_LV <- unlist(0)
pre2009$Residual_LP <- unlist(0)
post2009$CU <- unlist(0)
post2009$CO <- unlist(0)
post2009$OV <- unlist(0)
post2009$PE <- unlist(0)
post2009$AV <- unlist(0)
post2009$GA <- unlist(0)
post2009$CU <- ifelse((post2009$TEC_CUY== 1 | post2009$PAT_CUY == 1),1,0)
post2009$CO <- ifelse((post2009$TEC_CON == 1 | post2009$PAT_CON == 1), 1,0)
post2009$OV <- ifelse((post2009$TEC_OVE == 1 | post2009$PAT_OVE == 1), 1,0)
post2009$PE <- ifelse((post2009$TEC_PER == 1 | post2009$PAT_PER == 1), 1,0)
post2009$AV <- ifelse((post2009$TEC_AVE== 1 | post2009$PAT_AVE == 1), 1,0)
post2009$GA <- ifelse((post2009$TEC_GAT == 1 | post2009$PAT_GAT == 1), 1,0)
pre2009$PE_BLOQ <- 0
pre2009$PE_BLOQ[grep("BLOQ",pre2009$PE_MAT)] <- 1
pre2009$PE_PIE <- 0
pre2009$PE_PIE[grep("PIE",pre2009$PE_MAT)] <- 1
pre2009$FR_A <- ifelse(pre2009$FR_A <= 9,2000+pre2009$FR_A, pre2009$FR_A)
pre2009$FR_A[pre2009$FR_A == 2000] <- 0
pre2009$STATUS <- ifelse(pre2009$Residual_T==1,"T",0)
pre2009$STATUS <- ifelse(pre2009$Residual_R==1,"R",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_C==1,"C",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_D==1,"DES",pre2009$STATUS)
pre2009$STATUS[(pre2009$STATUS==0) & grepl("P.",pre2009$NOTAS, fixed = TRUE)] <- "LP"
pre2009$STATUS[(pre2009$STATUS==0) & (grepl("V.",pre2009$NOTAS, fixed = TRUE) | grepl("LOTE VACIO",pre2009$NOTAS))] <- "LV"
pre2009$UNICODE<-paste(pre2009$P,pre2009$D,pre2009$L,pre2009$V,sep=".")
colnames(post2009)[colnames(post2009)=="JEFE_FAMILIA"] <- "JEFEVIV"
colnames(post2009)[colnames(post2009)=="BRIGADISTA"] <- "ROCIADOR"
colnames(post2009)[colnames(post2009)=="I_NUM_AMB"] <- "IN_AMB"
colnames(post2009)[colnames(post2009)=="I_S" ] <- "IN_SIL"
colnames(post2009)[colnames(post2009)=="I_NO"] <-  "IN_NOB"
colnames(post2009)[colnames(post2009)=="I_LAD" ] <- "IN_LAD"
colnames(post2009)[colnames(post2009)== "I_AD"] <-"IN_ADO"
colnames(post2009)[colnames(post2009)=="I_TRIAT"] <- "IN_TRI"
colnames(post2009)[colnames(post2009)=="P_GRI"] <- "PE_GRI"
colnames(post2009)[colnames(post2009)=="P_TRIAT"] <- "PE_TRI"
colnames(post2009)[colnames(post2009)=="No_CARGAS"] <-"CARGASNTSCD"
colnames(post2009)[colnames(post2009)=="SUP_M2"] <- "SUPER"
colnames(post2009)[colnames(post2009)=="OBSERVACIONES" ] <- "NOTAS"
colnames(post2009)[colnames(post2009)=="P_BLOQ" ] <- "PE_BLOQ"
colnames(post2009)[colnames(post2009)=="P_PIE"] <-  "PE_PIE"
colnames(post2009)[colnames(post2009)=="I_GRI"] <- "IN_GRI"
colnames(post2009)[colnames(post2009)=="P_S" ] <-  "PE_SIL"
prepost<-rbind.general(pre2009,post2009)
length(intersect(names(pre2009),names(post2009)))
prepost$PE_SIL[prepost$PE_SIL == 24] <- 1
prepost$IN_GRI[prepost$IN_GRI == "X"] <- 1
prepost$PE_GRI[prepost$PE_GRI == "X"] <- 1
prepost$IN_GRI[prepost$IN_GRI == 3] <- 1
prepost$ROCIADOR <- toupper(iconv(prepost$ROCIADOR, to="ASCII//TRANSLIT"))
prepost$ROCIADOR <- gsub(" *$","",prepost$ROCIADOR)
prepost$ROCIADOR <- gsub(" [A-Z].$","",prepost$ROCIADOR)
prepost$ROCIADOR[prepost$ROCIADOR == "CARLOS VELAVELA"] <- "CARLOS VELA VELA"
prepost$ROCIADOR[prepost$ROCIADOR == "CRISTIAN VELASQUEZ"] <- "CRISTHIAN VELASQUEZ"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "OSCAR BARRIOS"] <- "OSCAR BARRIOS ZEA"
prepost$ROCIADOR[prepost$ROCIADOR == "VIDAL MAYTA"] <- "VIDAL MAYTA HUANCA"
prepost$ROCIADOR[prepost$ROCIADOR == "E. MANZANEDA"] <- "EDGAR MANZANEDA"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "VANDER TICONA"] <- "VANDER TICONA CUBA"
prepost$ROCIADOR[prepost$ROCIADOR == "EDGAR TITO"] <- "EDGARD TITO"
prepost$ROCIADOR[prepost$ROCIADOR == "RAFAEL VALDIVIA"] <- "RAFAEL VALDIVIA RODRIGUEZ"
prepost$IdObserver <- unlist(0)
prepost$IdObserver <- as.numeric(factor(prepost$ROCIADOR))
prepost$JEFEVIV <- toupper(iconv(prepost$JEFEVIV, to="ASCII//TRANSLIT"))
write.csv(prepost,"generalRociadoPA_Javier.csv",row.names=FALSE)
rm(pre2009)
rm(post2009)
pre2009<-read.csv("UNION_ROCIADOS.csv",header=TRUE, sep=";")
head(pre2009)
post2009<-read.csv("CONS_ROCIADO_2009_2015_con_cerradas.csv",header=TRUE)
head(post2009)
pre2009<-set_to(pre2009,init=c("NULL"),final=0)
post2009<-set_to(post2009)
colnames(pre2009)[colnames(pre2009)=="I.cap.T"] <- "IN_TRI"
colnames(pre2009)[colnames(pre2009)=="P.cap.T"] <- "PE_TRI"
colnames(pre2009)[colnames(pre2009)=="Nb.cargas"] <- "CARGASNTSCD"
colnames(pre2009)[colnames(pre2009)=="sup.m2"] <- "SUPER"
colnames(pre2009)[colnames(pre2009)=="CICLO"] <- "CICLO_ROCIADO"
colnames(pre2009)[colnames(pre2009)=="OBSERVACIONES"] <- "NOTAS"
colnames(pre2009)[colnames(pre2009)=="I.num.amb"] <- "IN_AMB"
colnames(pre2009)[colnames(pre2009)=="P.num.amb"] <- "PE_AMB"
colnames(pre2009)[colnames(pre2009)=="I.Gri"] <- "IN_GRI"
colnames(pre2009)[colnames(pre2009)=="P.Gri"] <- "PE_GRI"
colnames(pre2009)[colnames(pre2009)=="I.S"] <- "IN_SIL"
colnames(pre2009)[colnames(pre2009)=="I.NO"] <- "IN_NOB"
colnames(pre2009)[colnames(pre2009)=="I.AD"] <- "IN_ADO"
colnames(pre2009)[colnames(pre2009)=="I.LSE"] <- "IN_LAD"
colnames(pre2009)[colnames(pre2009)=="P.S"] <- "PE_SIL"
colnames(pre2009)[colnames(pre2009)=="P.NO"] <- "PE_NOB"
colnames(pre2009)[colnames(pre2009)=="P.LSE"] <- "PE_LAD"
colnames(pre2009)[colnames(pre2009)=="P.AD"] <- "PE_ADO"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.DEL.BRIGADISTA"] <- "ROCIADOR"
colnames(pre2009)[colnames(pre2009)=="NOMBRE.JEFE.DE.FAMILIA"] <- "JEFEVIV"
colnames(pre2009)[colnames(pre2009)=="No.RESID"] <- "NUMRES"
colnames(pre2009)[colnames(pre2009)=="P.otro"] <- "PE_MAT"
colnames(pre2009)[colnames(pre2009)=="I.otro"] <- "IN_MAT"
names(pre2009) <- gsub("\\.", "_", names(pre2009))
names(post2009) <- gsub("\\.", "_", names(post2009))
pre2009$Residual_T <- as.numeric(pre2009$Residual_Rec == 1 | pre2009$Residual_T == 1)
pre2009$Residual_LV <- unlist(0)
pre2009$Residual_LP <- unlist(0)
post2009$CU <- unlist(0)
post2009$CO <- unlist(0)
post2009$OV <- unlist(0)
post2009$PE <- unlist(0)
post2009$AV <- unlist(0)
post2009$GA <- unlist(0)
post2009$CU <- ifelse((post2009$TEC_CUY== 1 | post2009$PAT_CUY == 1),1,0)
post2009$CO <- ifelse((post2009$TEC_CON == 1 | post2009$PAT_CON == 1), 1,0)
post2009$OV <- ifelse((post2009$TEC_OVE == 1 | post2009$PAT_OVE == 1), 1,0)
post2009$PE <- ifelse((post2009$TEC_PER == 1 | post2009$PAT_PER == 1), 1,0)
post2009$AV <- ifelse((post2009$TEC_AVE== 1 | post2009$PAT_AVE == 1), 1,0)
post2009$GA <- ifelse((post2009$TEC_GAT == 1 | post2009$PAT_GAT == 1), 1,0)
pre2009$PE_BLOQ <- 0
pre2009$PE_BLOQ[grep("BLOQ",pre2009$PE_MAT)] <- 1
pre2009$PE_PIE <- 0
pre2009$PE_PIE[grep("PIE",pre2009$PE_MAT)] <- 1
pre2009$FR_A <- ifelse(pre2009$FR_A <= 9,2000+pre2009$FR_A, pre2009$FR_A)
pre2009$FR_A[pre2009$FR_A == 2000] <- 0
pre2009$STATUS <- ifelse(pre2009$Residual_T==1,"T",0)
pre2009$STATUS <- ifelse(pre2009$Residual_R==1,"R",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_C==1,"C",pre2009$STATUS)
pre2009$STATUS <- ifelse(pre2009$Residual_D==1,"DES",pre2009$STATUS)
pre2009$Residual_LP <- ifelse(pre2009$STATUS == "LP",1,0)
pre2009$Residual_LV <- ifelse(pre2009$STATUS == "LV",1,0)
pre2009$STATUS[(pre2009$STATUS==0) & grepl("P.",pre2009$NOTAS, fixed = TRUE)] <- "LP"
pre2009$STATUS[(pre2009$STATUS==0) & (grepl("V.",pre2009$NOTAS, fixed = TRUE) | grepl("LOTE VACIO",pre2009$NOTAS))] <- "LV"
pre2009$Residual_LP <- ifelse(pre2009$STATUS == "LP",1,0)
pre2009$Residual_LV <- ifelse(pre2009$STATUS == "LV",1,0)
pre2009$UNICODE<-paste(pre2009$P,pre2009$D,pre2009$L,pre2009$V,sep=".")
colnames(post2009)[colnames(post2009)=="JEFE_FAMILIA"] <- "JEFEVIV"
colnames(post2009)[colnames(post2009)=="BRIGADISTA"] <- "ROCIADOR"
colnames(post2009)[colnames(post2009)=="I_NUM_AMB"] <- "IN_AMB"
colnames(post2009)[colnames(post2009)=="I_S" ] <- "IN_SIL"
colnames(post2009)[colnames(post2009)=="I_NO"] <-  "IN_NOB"
colnames(post2009)[colnames(post2009)=="I_LAD" ] <- "IN_LAD"
colnames(post2009)[colnames(post2009)== "I_AD"] <-"IN_ADO"
colnames(post2009)[colnames(post2009)=="I_TRIAT"] <- "IN_TRI"
colnames(post2009)[colnames(post2009)=="P_GRI"] <- "PE_GRI"
colnames(post2009)[colnames(post2009)=="P_TRIAT"] <- "PE_TRI"
colnames(post2009)[colnames(post2009)=="No_CARGAS"] <-"CARGASNTSCD"
colnames(post2009)[colnames(post2009)=="SUP_M2"] <- "SUPER"
colnames(post2009)[colnames(post2009)=="OBSERVACIONES" ] <- "NOTAS"
colnames(post2009)[colnames(post2009)=="P_BLOQ" ] <- "PE_BLOQ"
colnames(post2009)[colnames(post2009)=="P_PIE"] <-  "PE_PIE"
colnames(post2009)[colnames(post2009)=="I_GRI"] <- "IN_GRI"
colnames(post2009)[colnames(post2009)=="P_S" ] <-  "PE_SIL"
prepost<-rbind.general(pre2009,post2009)
length(intersect(names(pre2009),names(post2009)))
prepost$PE_SIL[prepost$PE_SIL == 24] <- 1
prepost$IN_GRI[prepost$IN_GRI == "X"] <- 1
prepost$PE_GRI[prepost$PE_GRI == "X"] <- 1
prepost$IN_GRI[prepost$IN_GRI == 3] <- 1
prepost$ROCIADOR <- toupper(iconv(prepost$ROCIADOR, to="ASCII//TRANSLIT"))
prepost$ROCIADOR <- gsub(" *$","",prepost$ROCIADOR)
prepost$ROCIADOR <- gsub(" [A-Z].$","",prepost$ROCIADOR)
prepost$ROCIADOR[prepost$ROCIADOR == "CARLOS VELAVELA"] <- "CARLOS VELA VELA"
prepost$ROCIADOR[prepost$ROCIADOR == "CRISTIAN VELASQUEZ"] <- "CRISTHIAN VELASQUEZ"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "OSCAR BARRIOS"] <- "OSCAR BARRIOS ZEA"
prepost$ROCIADOR[prepost$ROCIADOR == "VIDAL MAYTA"] <- "VIDAL MAYTA HUANCA"
prepost$ROCIADOR[prepost$ROCIADOR == "E. MANZANEDA"] <- "EDGAR MANZANEDA"
prepost$ROCIADOR[prepost$ROCIADOR == "JAIME ROJAS"] <- "JAIME ROJAS VILCA"
prepost$ROCIADOR[prepost$ROCIADOR == "VANDER TICONA"] <- "VANDER TICONA CUBA"
prepost$ROCIADOR[prepost$ROCIADOR == "EDGAR TITO"] <- "EDGARD TITO"
prepost$ROCIADOR[prepost$ROCIADOR == "RAFAEL VALDIVIA"] <- "RAFAEL VALDIVIA RODRIGUEZ"
prepost$IdObserver <- unlist(0)
prepost$IdObserver <- as.numeric(factor(prepost$ROCIADOR))
prepost$JEFEVIV <- toupper(iconv(prepost$JEFEVIV, to="ASCII//TRANSLIT"))
write.csv(prepost,"generalRociadoPA_Javier.csv",row.names=FALSE)
